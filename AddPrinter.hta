<!doctype html>
    <head>
        <meta charset="utf-8">
        
        <title>Add Library Printers</title>
        
        <meta name="description" content="Add Library Printers">
	
	<SCRIPT Language="VBScript" type="text/vbscript" id="WindowResize">
		Const WINDOW_WIDTH = 600
		Const WINDOW_HEIGHT = 500
		window.offscreenBuffering = TRUE
		window.resizeTo WINDOW_WIDTH,WINDOW_HEIGHT
		window.moveTo (window.screen.width - WINDOW_WIDTH) / 2, (window.screen.height - WINDOW_HEIGHT) / 2
	</SCRIPT>

	<HTA:APPLICATION
  APPLICATIONNAME="NC Add Printers Wizard"
  VERSION="1.0"
  BORDER="dialog"
  MAXIMIZEBUTTON="no"
  ICON="addprinter.ico"
  SCROLL="no"
  SINGLEINSTANCE="yes"/>
	 
		<style>
/* 
http://meyerweb.com/eric/tools/css/reset/ 
v2.0 | 20110126
License: none (public domain)
*/

/* RESET CSS BEGIN */
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
/* END RESET CSS END */

/* BEGIN CSS STYLE BEGIN */

/* TEXT STYLE */
		h1 {
			position: Fixed;
			font-family:;
			padding-left 2%;
			padding-top 20px;
			font-size: 400%;
			}
		h2 {
			position: Fixed;
			font-family:;
			font-size: 200%;
			text-algin: right;
			margin-top: 11%;
			margin-left: 20%;
			}
		h4 {
			font-family:"Georgia,serif";
			letter-spacing: 1px;
			padding-bottom: 7px;
			}
		.center {text-align:center;}
		.left  {text-align:left;}
		.right {text-align:right;}
		.bold{font-weight:600;}
/* BACKGROUND STYLE */
		.logo{
			position: relative;
			width: 20%;
			margin-left: 1%;
			margin-top: 1%;
			margin-bottom: 1%
			}
		.bgBlue {
		  background-color:#0073CF; 
		  color:#FFF;
		  }
		 .topBorder 
		  border-color:black; 
		  border-top-style:solid;
		 }
		body {background-color: #FFF;}
/* WRAPPER STYLE */
        .wrapper {
			width: 100%;
			position: relative;
			border-width: 7px;
			border-color: black;
			border-bottom-style: solid;
			border-top-style: solid;
			padding-top: 5%;
			padding-bottom: 5%;
			}
		.leftcolumn {
			float:left;
			width: 50%
			position: fixed;
			}
		.rightcolumn {
			float:right;
			width: 50%;
			}
/* Margins */
		.leftmargin1 {
			margin-left: 1%;
			}
		.leftpad52 {
			padding-left: 52%}
		.toppad10 {
			padding-top: 1%
		}
		</style>

	
    </head>

    <body>

		</div>
		<div id="theRest">	
			<div>
				<img alt="Niagara College's Library Logo" class="logo" src="NC_Button.png">
				<h1>Libraries</h1>
				<h2>Printer Wizard</h2>
			</div>
			<div class="wrapper bgBlue">
				<div class="leftcolumn">
					<div class="leftmargin1">
						<h4>1) Choose Printer to Install</h4>
						<input type="checkbox" name="LibraryBlack"> Library Black Printer<br>
						<input type="checkbox" name="LibraryColour"> Library Colour Printer<br>
						<input type="checkbox" name="LibraryHP"> LibraryHP 11x17<br>
					</div>
					<br>
					<div class="leftmargin1">
						<h4>2) Choose Default Printer</h4>
							<select size="1" name="DefaultPrinter" class="widthD">
								<p><option value="LibraryBlack">Library Black</option>
								<option value="LibraryColour">Library Colour</option>
								<option value="LibraryHP">LibraryHP 11x17</option></p>
							</select>
					</div>
				</div>
				<div class="rightclumn">
					<div class="leftpad52">
						<h4>3) Authorize Your Account</h4>
						<P>Enter your <span class="bold">BlackBoard</span> login:</P>		
						<P>Username: <INPUT TYPE="TEXT" class="widthT" NAME="usernamebox"></P>
						<P>Password: <INPUT TYPE="PASSWORD" class="widthT" NAME="passwordbox"></P>
					</div>
				</div>
			</div>
			<div class="center topBorder">
			&nbsp;
			<br>
			<br>
<!-- Need to build out vbscript for delete button. --> 
				<INPUT TYPE="BUTTON" NAME="SUBMIT" VALUE="Install Library Printer(s)" title="Click this after selecting desired printers.">
				<INPUT TYPE="BUTTON" NAME="DELPRINTERS" VALUE="Delete Library Printers" title="Delete installed Niagara College Printers.">
			</div>	
			
		</div>
			
			
			<SCRIPT LANGUAGE="VBScript">
'*****************************************************************
'Define Variables for campus, server path, rooms, printer names
'*****************************************************************

Dim wellandUNCpath
wellandUNCpath="\\wcprt03.local.niagarac.on.ca\"

Dim notlUNCpath
notlUNCpath="\\gcprt02.local.niagarac.on.ca\"

'Printer Names, Define printers for rooms here.
' abbreviation prnt denotes printer
' lib denotes room
' wel denotes campus

' Should be a variable array but I can't get it to work. See http://www.w3schools.com/vbscript/vbscript_variables.asp

'Welland Library Printers
Dim prntwellib0
prntwellib0="LibraryBlack"
Dim prntwellib1
prntwellib1="LibraryColour"
Dim prntwellib2
prntwellib2="LibraryHP"


'***************************************************************
'Begin network test to make sure user is on the correct domain.
'***************************************************************

		set objShell=CreateObject("WScript.Shell")
		strCommand="ping -n 1 127.0.0.1"
	    'strCommand="ping -n 1 wcprt03.local.niagarac.on.ca" TEMPORARILY DISABLED WHILE TESTING. TURN ON FOR PRODUCTION
		set objProc=objShell.Exec(strCommand)

		Do    
		 line = objProc.StdOut.ReadLine()
		 s = s & line & vbcrlf
		Loop While Not objProc.Stdout.atEndOfStream

		If InStr(s,"Reply from")=0 Then
			'*Not connected to NC Network
			MsgBox "You must be connected to the College's Wired or Wireless Networks (AirNC-Secure) to add printers.  Please connect and run the program again", vbExclamation, "Error"
			window.close()
		Else
			'Connected to NC Network (all is good)
		End if 
'**************************************************************************************
'End network Test and begin loading the UI.
'**************************************************************************************
		Sub Window_Onload
			HiddenInstallMessage.Style.Visibility="hidden" ' Hide the installing wait message
			usernamebox.Focus ' Set the username box to the cursor immediately
		End Sub

' Keycode 13 is for the enter key.
		Sub passwordbox_OnKeyDown
			With document.parentWindow.event
				If .keycode = 13 Then
					Submit_onClick
				End If
			End With
		End Sub

' Passing creds to variables to include NC\ and add printers via checkboxes
		Sub Submit_onClick
			sUserName = usernamebox.Value
			sPassword = passwordbox.Value
' Reload on failure to enter creds			
			If sUserName = "" Or sPassword = "" Then
				MsgBox "You must enter a username and password. This program will now restart.", vbExclamation, "Error"
				Location.Reload(True)
			Else
				sFullUsername = "nc\" & sUserName	
				

' ********************************************************************************************************************
' DEPRICATED INSTALL MESSAGE
' This hides the window contents and shows activity. We can probably do better with a scrollbar or something here. 			
'				theRest.Style.Visibility="hidden"
'				Install.Style.Visibility="visible"
'*********************************************************************************************************************


' Change cmdkey add value into a variable for campus awareness		
				set objShell = CreateObject("WScript.Shell")
					Return = objShell.Run("cmdkey /add:wcprt03.local.niagarac.on.ca /user:" & sFullUsername & " /pass:" & sPassword, 1, True)
				Set objNetwork = CreateObject("WScript.Network")
' More hard links to the domain that could be replaced variables throughout. 			
				If LibraryBlack.Checked = FALSE And LibraryColour.Checked = FALSE And LibraryHP.Checked = FALSE  Then
					MsgBox "You must select at least one printer to install.  Please re-open the progam and try again.", vbExclamation, "Error"
				Else
					If LibraryBlack.Checked Then
						objNetwork.AddWindowsPrinterConnection wellandUNCpath & prntwellib0
					End If
			
					If LibraryColour.Checked Then
						objNetwork.AddWindowsPrinterConnection wellandUNCpath & prntwellib1
					End If
			
					If LibraryHP.Checked Then
						objNetwork.AddWindowsPrinterConnection wellandUNCpath & prntwellib2
					End If
'*******************************************************
' Set default printer 
'*******************************************************
					Set SelOpt = DefaultPrinter.Options(DefaultPrinter.selectedIndex)
					objNetwork.SetDefaultPrinter "\\wcprt03.local.niagarac.on.ca\" & SelOpt.Value
					MsgBox "Printer added successfully. Quitting Application.", vbInformation, "Success"
					computerSleep(1)
			
					window.close()
				End If
			End If
		End Sub
' Not really sure what this part of the script is doing exactly. It's waiting for the printers to install maybe?
		Sub computerSleep(seconds)
			Set objShell = CreateObject("Wscript.Shell")
			cmd = "%COMSPEC% /c ping -n " & 1 + seconds & " 127.0.0.1>nul"
			objShell.Run cmd,0,1
		End Sub
' Instead of hiding everything in the window and showing this message maybe we could hide a message at the bottom of the window and show it on top of the ui as an inverse.
		</SCRIPT>
		<div ID="HiddenInstallMessage" class="center toppad10">
			<h3>
				Installing Printer(s)..... Please be patient!
			</h3>
    </body>
</html>