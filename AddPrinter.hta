<!doctype html>
    <head>
        <meta charset="utf-8">
		
        <title>Add Library Printers</title>
        <meta name="description" content="Add Library Printers">
		
	<SCRIPT Language="VBScript" type="text/vbscript" id="WindowResize">
		Const WINDOW_WIDTH = 600
		Const WINDOW_HEIGHT = 500
		window.offscreenBuffering = TRUE

		window.resizeTo WINDOW_WIDTH,WINDOW_HEIGHT
		window.moveTo (window.screen.width - WINDOW_WIDTH) / 2, (window.screen.height - WINDOW_HEIGHT) / 2
	</SCRIPT>
	
	<HTA:APPLICATION
	APPLICATIONNAME="Add Printers"
	BORDER="thin"
	SCROLL="no"
	SINGLEINSTANCE="yes"
	WINDOWSTATE="normal"
	>
	 
	<style>
/* 
http://meyerweb.com/eric/tools/css/reset/ 
v2.0 | 20110126
License: none (public domain)
*/
/* RESET CSS BEGIN */
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
/* END RESET CSS END */

/* BEGIN CSS STYLE BEGIN */

/* TEXT STYLE */
		h1 {
			position: Fixed;
			font-family:;
			padding-left 2%;
			padding-top 20px;
			font-size: 400%;
			}
		h2 {
			position: Fixed;
			font-family:;
			font-size: 200%;
			text-algin: right;
			margin-top: 11%;
			margin-left: 20%;
			}
		h4 {
			font-family:"Georgia,serif";
			letter-spacing: 1px;
			padding-bottom: 7px;
			}
		.center {text-align:center;}
		.left  {text-align:left;}
		.right {text-align:right;}
		.bold{font-weight:600;}
/* BACKGROUND STYLE */
		.logo{
			position: relative;
			width: 20%;
			margin-left: 1%;
			margin-top: 1%;
			margin-bottom: 1%
			}
		.bgBlue {
		  background-color:#0073CF; 
		  color:#FFF;
		  }
		 .topBorder 
		  border-color:black; 
		  border-top-style:solid;
		 }
		body {background-color: #FFF;}
/* WRAPPER STYLE */
        .wrapper {
			width: 100%;
			position: relative;
			border-width: 7px;
			border-color: black;
			border-bottom-style: solid;
			border-top-style: solid;
			padding-top: 5%;
			padding-bottom: 5%;
			}
		.leftcolumn {
			float:left;
			width: 50%
			position: fixed;
			}
		.rightcolumn {
			float:right;
			width: 50%;
			}
/* Margins */
		.leftmargin1 {
			margin-left: 1%;
			}
		.leftpad52 {
			padding-left: 52%}
		.toppad10 {
			padding-top: 1%
		}
	</style>

	
    </head>
    <body>

		</div>
		<div id="theRest">	
			<div>
				<img alt="Niagara College's Library Logo" class="logo" src="http://www.niagaracollege.ca/virtualtour/assets/NC_Button.png">
				<h1>Libraries</h1>
				<h2>Printer Wizard</h2>
			</div>
			<div class="wrapper bgBlue">
				<div class="leftcolumn">
					<div class="leftmargin1">
						<h4>1) Choose Printer to Install</h4>
						<input type="checkbox" name="LibraryBlack"> Library Black Printer<br>
						<input type="checkbox" name="LibraryColour"> Library Colour Printer<br>
						<input type="checkbox" name="LibraryHP"> LibraryHP 11x17<br>
					</div>
					<br>
					<div class="leftmargin1">
						<h4>2) Choose Default Printer</h4>
							<select size="1" name="DefaultPrinter" class="widthD">
								<p><option value="LibraryBlack">Library Black</option>
								<option value="LibraryColour">Library Colour</option>
								<option value="LibraryHP">LibraryHP 11x17</option></p>
							</select>
					</div>
				</div>
				<div class="rightclumn">
					<div class="leftpad52">
						<h4>3) Authorize Your Account</h4>
						<P>Enter your <span class="bold">BlackBoard</span> login:</P>		
						<P>Username: <INPUT TYPE="TEXT" class="widthT" NAME="usernamebox"></P>
						<P>Password: <INPUT TYPE="PASSWORD" class="widthT" NAME="passwordbox"></P>
					</div>
				</div>
			</div>
			<div class="center topBorder">
			&nbsp;
			<br>
			<br>
				<INPUT TYPE="BUTTON" NAME="SUBMIT" VALUE="Install Library Printer(s)">
				<INPUT TYPE="BUTTON" NAME="DELPRINTERS" VALUE="Delete Library Printers">
			</div>	
			
		</div>
			
			
			<SCRIPT LANGUAGE="VBScript">

		set objShell=CreateObject("WScript.Shell")
		strCommand="ping -n 1 127.0.0.1"
		'* strCommand="ping -n 1 wcprt03.local.niagarac.on.ca"
		set objProc=objShell.Exec(strCommand)

		Do    
		 line = objProc.StdOut.ReadLine()
		 s = s & line & vbcrlf
		Loop While Not objProc.Stdout.atEndOfStream

		If InStr(s,"Reply from")=0 Then
			'*Not connected to NC Network
			MsgBox "You must be connected to the College's Wired or Wireless Networks (AirNC-Secure) to add printers.  Please connect and run the program again", vbExclamation, "Error"
			window.close()
		Else
			'Connected to NC Network (all is good)
		End if 

		Sub Window_Onload
			Install.Style.Visibility="hidden"
			usernamebox.Focus
		End Sub

		Sub passwordbox_OnKeyDown
			With document.parentWindow.event
				If .keycode = 13 Then
					Submit_onClick
				End If
			End With
		End Sub

		' Passing creds to variables to include NC\ and add printers via checkboxes
		Sub Submit_onClick
			sUserName = usernamebox.Value
			sPassword = passwordbox.Value
			
			If sUserName = "" Or sPassword = "" Then
				MsgBox "You must enter a username and password.  Please re-open the program and try again.", vbExclamation, "Error"
			Else
				sFullUsername = "nc\" & sUserName	
			
				theRest.Style.Visibility="hidden"
				Install.Style.Visibility="visible"
			
				set objShell = CreateObject("WScript.Shell")
					Return = objShell.Run("cmdkey /add:wcprt03.local.niagarac.on.ca /user:" & sFullUsername & " /pass:" & sPassword, 1, True)
				Set objNetwork = CreateObject("WScript.Network")
			
				If LibraryBlack.Checked = FALSE And LibraryColour.Checked = FALSE And LibraryHP.Checked = FALSE  Then
					MsgBox "You must select at least one printer to install.  Please re-open the progam and try again.", vbExclamation, "Error"
				Else
					If LibraryBlack.Checked Then
						objNetwork.AddWindowsPrinterConnection "\\wcprt03.local.niagarac.on.ca\LibraryBlack"
					End If
			
					If LibraryColour.Checked Then
						objNetwork.AddWindowsPrinterConnection "\\wcprt03.local.niagarac.on.ca\LibraryColour"
					End If
			
					If LibraryHP.Checked Then
						objNetwork.AddWindowsPrinterConnection "\\wcprt03.local.niagarac.on.ca\LibraryHP"
					End If
			
					Set SelOpt = DefaultPrinter.Options(DefaultPrinter.selectedIndex)

					objNetwork.SetDefaultPrinter "\\wcprt03.local.niagarac.on.ca\" & SelOpt.Value
					MsgBox "Printer added successfully. Quitting Application.", vbInformation, "Success"
					computerSleep(1)
			
					window.close()
				End If
			End If
		End Sub

		Sub computerSleep(seconds)
			Set objShell = CreateObject("Wscript.Shell")
			cmd = "%COMSPEC% /c ping -n " & 1 + seconds & " 127.0.0.1>nul"
			objShell.Run cmd,0,1
		End Sub

		</SCRIPT>
		<div ID="Install">
			<h3>
				Installing Printer(s)..... Please be patient!
			</h3>
    </body>
</html>
